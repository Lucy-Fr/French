<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Expressions courantes (4) â€” dialogues + audio</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; }
    .question { margin-bottom: 25px; }
    .correct { background-color: #c8f7c5; }
    .missed { background-color: #fce3e3; }
    select { padding: 5px; }
    button { margin: 10px 5px; }
    table { border-collapse: collapse; margin-bottom: 30px; }
    th, td { padding: 6px 12px; border: 1px solid #ccc; text-align: left; }
  </style>
</head>
<body>

<h2>ğŸ“˜ Expressions courantes â€” SÃ©rie 4</h2>
<p>ComplÃ©tez chaque dialogue avec l'expression correcte. Cliquez sur ğŸ”Š pour Ã©couter.</p>

<div id="exercise-container"></div>

<p id="score"></p>
<button onclick="checkAnswers()">VÃ©rifier</button>
<button onclick="location.reload()">RÃ©initialiser</button>

<p>
  <a href="../a1_expressions.html">â† Retour aux expressions</a> |
  <a href="../../index.html">ğŸ  Accueil</a>
</p>

<script>
const expressions = [
  "Câ€™est pas possible !", "Jâ€™en doute", "Tant pis", "Ã‡a marche",
  "Je tâ€™en prie", "Fais gaffe !", "Ã‡a ne me dit rien",
  "Jâ€™y pense", "Ã‡a me saoule", "Tu veux rire ?"
];

const dialogues = [
  {
    full: "â€” Tu as payÃ© 200 euros pour Ã§a ? â€” Tu veux rire ?",
    withGap: "â€” Tu as payÃ© 200 euros pour Ã§a ? â€” ___",
    answer: "Tu veux rire ?"
  },
  {
    full: "â€” Tu crois quâ€™il viendra ? â€” Jâ€™en doute.",
    withGap: "â€” Tu crois quâ€™il viendra ? â€” ___",
    answer: "Jâ€™en doute"
  },
  {
    full: "â€” On annule le rendez-vous ? â€” Tant pis.",
    withGap: "â€” On annule le rendez-vous ? â€” ___",
    answer: "Tant pis"
  },
  {
    full: "â€” Tu peux me prÃªter ton livre ? â€” Je tâ€™en prie.",
    withGap: "â€” Tu peux me prÃªter ton livre ? â€” ___",
    answer: "Je tâ€™en prie"
  },
  {
    full: "â€” Ce bruit toute la journÃ©e, jâ€™en peux plusâ€¦ â€” Ã‡a me saoule.",
    withGap: "â€” Ce bruit toute la journÃ©e, jâ€™en peux plusâ€¦ â€” ___",
    answer: "Ã‡a me saoule"
  },
  {
    full: "â€” On se retrouve devant la gare Ã  18h ? â€” Ã‡a marche.",
    withGap: "â€” On se retrouve devant la gare Ã  18h ? â€” ___",
    answer: "Ã‡a marche"
  },
  {
    full: "â€” Il a mangÃ© 5 burgers en 10 minutes ! â€” Câ€™est pas possible !",
    withGap: "â€” Il a mangÃ© 5 burgers en 10 minutes ! â€” ___",
    answer: "Câ€™est pas possible !"
  },
  {
    full: "â€” Fais attention Ã  la marche ! â€” Fais gaffe !",
    withGap: "â€” Fais attention Ã  la marche ! â€” ___",
    answer: "Fais gaffe !"
  },
  {
    full: "â€” On va au concert ce soir ? â€” Ã‡a ne me dit rien.",
    withGap: "â€” On va au concert ce soir ? â€” ___",
    answer: "Ã‡a ne me dit rien"
  },
  {
    full: "â€” Tu sais, je pensais justement Ã  Ã§a. â€” Jâ€™y pense.",
    withGap: "â€” Tu sais, je pensais justement Ã  Ã§a. â€” ___",
    answer: "Jâ€™y pense"
  }
];

// Fonction pour mÃ©langer les options alÃ©atoirement
function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}

function speak(text) {
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = 'fr-FR';
  const voices = speechSynthesis.getVoices();
  const fr = voices.find(v => v.lang === 'fr-FR');
  if (fr) utterance.voice = fr;
  speechSynthesis.speak(utterance);
}

speechSynthesis.onvoiceschanged = () => {};

function renderExercise() {
  const container = document.getElementById("exercise-container");
  dialogues.forEach((dlg, i) => {
    const id = "q" + i;
    const shuffled = shuffle([...expressions]);
    const options = shuffled.map(exp => `<option value="${exp}">${exp}</option>`).join("");
    container.innerHTML += `
      <div class="question">
        <button onclick="speak('${dlg.full}')">ğŸ”Š Ã‰couter</button><br>
        ${dlg.withGap.replace("___", `<select id="${id}"><option value="">â€”</option>${options}</select>`)}
      </div>
    `;
  });
}

function checkAnswers() {
  let score = 0;
  dialogues.forEach((dlg, i) => {
    const sel = document.getElementById("q" + i);
    sel.classList.remove("correct", "missed");
    if (sel.value === dlg.answer) {
      sel.classList.add("correct");
      score++;
    } else {
      sel.classList.add("missed");
    }
  });
  document.getElementById("score").innerText = `RÃ©sultat : ${score} / ${dialogues.length}`;
}

window.onload = renderExercise;
</script>

</body>
</html>
