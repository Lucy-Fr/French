<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Expressions courantes â€” Exercice interactif</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; }
    .question { margin-bottom: 20px; }
    .correct { background-color: #c8f7c5; }
    .missed { background-color: #fce3e3; }
    .explanation { display: none; color: green; margin-top: 5px; }
    button { margin: 10px 5px; }
    input { padding: 3px; }
    select { padding: 3px; }
  </style>
</head>
<body>

<h2>ğŸ—£ Expressions courantes â€” Exercices interactifs</h2>
<p>ComplÃ©tez les phrases ou choisissez la bonne rÃ©ponse. Cliquez sur ğŸ”Š pour Ã©couter.</p>

<h3>ğŸ’¬ Partie 1 â€” ComplÃ©tez avec une expression</h3>
<div id="fill-expressions"></div>
<button onclick="checkFill()">VÃ©rifier</button>
<p id="fill-score"></p>

<h3>ğŸ—¨ï¸ Partie 2 â€” Choisissez la bonne rÃ©plique</h3>
<div id="dialogue-expressions"></div>
<button onclick="checkDialogues()">VÃ©rifier</button>
<p id="dialogue-score"></p>

<button onclick="location.reload()">RÃ©initialiser</button>

<p>
  <a href="../a1_expressions.html">â† Retour aux expressions</a> |
  <a href="../../index.html">ğŸ  Accueil</a>
</p>

<script>
const expressions = [
  ["â€“ Tu vas bien ? â€” ___", "Ã‡a va, merci"],
  ["â€” Je suis dÃ©solÃ©. â€” ___", "Ce nâ€™est pas grave"],
  ["â€” Tu viens avec nous ? â€” ___", "Bien sÃ»r"],
  ["â€” Merci beaucoup ! â€” ___", "De rien"],
  ["â€” On se voit demain ? â€” ___", "Dâ€™accord"],
  ["â€” Tu as compris ? â€” ___", "Pas du tout"],
  ["â€” Il est lÃ  ? â€” ___", "Je ne sais pas"],
  ["â€” Ã‡a marche pour toi ? â€” ___", "Oui, Ã§a marche"],
  ["â€” Tu peux mâ€™aider ? â€” ___", "Pas de problÃ¨me"],
  ["â€” Ã€ bientÃ´t ! â€” ___", "Ã€ bientÃ´t"]
];

const dialogues = [
  ["â€” Tu veux un cafÃ© ?", ["Non, merci", "Je suis dÃ©solÃ©", "Ã€ demain"], "Non, merci"],
  ["â€” Merci pour ton aide !", ["De rien", "Pas de problÃ¨me", "Ã‡a va"], "De rien"],
  ["â€” Tu vas bien ?", ["Pas du tout", "Ã‡a va, merci", "Dâ€™accord"], "Ã‡a va, merci"],
  ["â€” Je ne comprends rien !", ["Pas du tout", "Pas de problÃ¨me", "Je ne sais pas"], "Pas du tout"],
  ["â€” On y va ?", ["Je suis dÃ©solÃ©", "Ã‡a marche", "Non, merci"], "Ã‡a marche"],
  ["â€” Tu es libre demain ?", ["Je ne sais pas", "Ã‡a va", "Ce nâ€™est pas grave"], "Je ne sais pas"],
  ["â€” Jâ€™ai oubliÃ© notre rendez-vousâ€¦", ["Ce nâ€™est pas grave", "Dâ€™accord", "De rien"], "Ce nâ€™est pas grave"],
  ["â€” On se retrouve Ã  18h ?", ["Ã€ bientÃ´t", "Dâ€™accord", "Pas de problÃ¨me"], "Dâ€™accord"],
  ["â€” Merci pour tout !", ["De rien", "Pas du tout", "Je ne sais pas"], "De rien"],
  ["â€” Je dois y allerâ€¦", ["Ã€ bientÃ´t", "Ã‡a va", "Je suis dÃ©solÃ©"], "Ã€ bientÃ´t"]
];

function speak(text) {
  const u = new SpeechSynthesisUtterance(text);
  u.lang = 'fr-FR';
  const voices = speechSynthesis.getVoices();
  const fr = voices.find(v => v.lang === 'fr-FR');
  if (fr) u.voice = fr;
  speechSynthesis.speak(u);
}

speechSynthesis.onvoiceschanged = () => {};

function renderFill() {
  const container = document.getElementById("fill-expressions");
  expressions.forEach(([text, answer], i) => {
    const id = "f" + i;
    const html = `<div class="question">${text.replace("___", `<input type="text" id="${id}" placeholder="...">`)}
      <button onclick="speak('${answer}')">ğŸ”Š</button>
      <div class="explanation" id="exp${id}">âœ… ${answer}</div></div>`;
    container.innerHTML += html;
  });
}

function renderDialogues() {
  const container = document.getElementById("dialogue-expressions");
  dialogues.forEach(([question, options, correct], i) => {
    const id = "d" + i;
    let html = `<div class="question"><strong>${question}</strong><br><select id="${id}">
      <option value="">â€”</option>`;
    options.forEach(opt => {
      html += `<option value="${opt}">${opt}</option>`;
    });
    html += `</select> <button onclick="speak('${correct}')">ğŸ”Š</button>
      <div class="explanation" id="exp${id}">âœ… ${correct}</div></div>`;
    container.innerHTML += html;
  });
}

function checkFill() {
  let score = 0;
  expressions.forEach(([, answer], i) => {
    const input = document.getElementById("f" + i);
    const exp = document.getElementById("expf" + i);
    const val = input.value.trim().toLowerCase();
    input.classList.remove("correct", "missed");
    if (val === answer.toLowerCase()) {
      input.classList.add("correct");
      score++;
    } else {
      input.classList.add("missed");
    }
    document.getElementById("expf" + i)?.classList?.add("shown");
    document.getElementById("expf" + i)?.style?.setProperty("display", "block");
  });
  document.getElementById("fill-score").innerText = `RÃ©sultat : ${score} / ${expressions.length}`;
}

function checkDialogues() {
  let score = 0;
  dialogues.forEach(([, , correct], i) => {
    const sel = document.getElementById("d" + i);
    const exp = document.getElementById("expd" + i);
    if (sel.value === correct) {
      sel.classList.add("correct");
      score++;
    } else {
      sel.classList.add("missed");
    }
    document.getElementById("expd" + i)?.style?.setProperty("display", "block");
  });
  document.getElementById("dialogue-score").innerText = `RÃ©sultat : ${score} / ${dialogues.length}`;
}

window.onload = function () {
  renderFill();
  renderDialogues();
};
</script>

</body>
</html>
