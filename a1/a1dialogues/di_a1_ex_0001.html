<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Dialogue : √Ä la boulangerie ‚Äî exercice √† trous</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .question { margin-bottom: 20px; }
    .correct { background-color: #c8f7c5; }
    .missed { background-color: #fce3e3; }
    .explanation { color: green; display: none; margin-top: 5px; }
    button { margin: 5px; }
  </style>
</head>
<body>

<h2>Dialogue complet ‚Äì √Ä la boulangerie</h2>
<div style="background:#f9f9f9; padding: 10px; border: 1px solid #ccc; margin-bottom: 20px;">
  <p><strong>Client :</strong> Bonjour, je voudrais une baguette, s'il vous pla√Æt.</p>
  <p><strong>Boulang√®re :</strong> Bien s√ªr ! Et avec ceci ?</p>
  <p><strong>Client :</strong> Je vais prendre aussi deux pains au chocolat.</p>
  <p><strong>Boulang√®re :</strong> Tr√®s bien. Ce sera tout ?</p>
  <p><strong>Client :</strong> Oui, merci. Combien je vous dois ?</p>
  <p><strong>Boulang√®re :</strong> √áa fait trois euros cinquante, s‚Äôil vous pla√Æt.</p>
  <p><strong>Client :</strong> Voil√†. Merci beaucoup.</p>
  <p><strong>Boulang√®re :</strong> Merci √† vous. Bonne journ√©e !</p>
</div>

<h3>–ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ —Ä—É—Å—Å–∫–∏–π</h3>
<div style="background:#f3f3f3; padding: 10px; border: 1px solid #ccc; margin-bottom: 30px;">
  <p><strong>–ü–æ–∫—É–ø–∞—Ç–µ–ª—å:</strong> –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, —è –±—ã —Ö–æ—Ç–µ–ª –±–∞–≥–µ—Ç, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞.</p>
  <p><strong>–ü—Ä–æ–¥–∞–≤—â–∏—Ü–∞:</strong> –ö–æ–Ω–µ—á–Ω–æ! –ß—Ç–æ-–Ω–∏–±—É–¥—å –µ—â—ë?</p>
  <p><strong>–ü–æ–∫—É–ø–∞—Ç–µ–ª—å:</strong> –Ø –≤–æ–∑—å–º—É –µ—â—ë –¥–≤–∞ —à–æ–∫–æ–ª–∞–¥–Ω—ã—Ö –∫—Ä—É–∞—Å—Å–∞–Ω–∞.</p>
  <p><strong>–ü—Ä–æ–¥–∞–≤—â–∏—Ü–∞:</strong> –•–æ—Ä–æ—à–æ. –≠—Ç–æ –≤—Å—ë?</p>
  <p><strong>–ü–æ–∫—É–ø–∞—Ç–µ–ª—å:</strong> –î–∞, —Å–ø–∞—Å–∏–±–æ. –°–∫–æ–ª—å–∫–æ —è –≤–∞–º –¥–æ–ª–∂–µ–Ω?</p>
  <p><strong>–ü—Ä–æ–¥–∞–≤—â–∏—Ü–∞:</strong> –° –≤–∞—Å —Ç—Ä–∏ –µ–≤—Ä–æ –ø—è—Ç—å–¥–µ—Å—è—Ç, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞.</p>
  <p><strong>–ü–æ–∫—É–ø–∞—Ç–µ–ª—å:</strong> –í–æ—Ç. –ë–æ–ª—å—à–æ–µ —Å–ø–∞—Å–∏–±–æ.</p>
  <p><strong>–ü—Ä–æ–¥–∞–≤—â–∏—Ü–∞:</strong> –°–ø–∞—Å–∏–±–æ –≤–∞–º. –•–æ—Ä–æ—à–µ–≥–æ –¥–Ω—è!</p>
</div>

<h2>Dialogue : √Ä la boulangerie ‚Äî exercice √† trous avec audio</h2>
<p>Compl√©tez les mots manquants dans ce dialogue. Cliquez sur üîä pour √©couter chaque ligne.</p>

<div id="dialogue-container"></div>

<button onclick="checkAnswers()">V√©rifier</button>
<button onclick="resetDialogue()">R√©initialiser</button>
<p id="score" class="result" style="display: none;"></p>

<script>
const dialogue = [
  ["Client", "Bonjour, je voudrais une ___, s'il vous pla√Æt.", "baguette"],
  ["Boulang√®re", "Bien s√ªr ! Et avec ceci ?", ""],
  ["Client", "Je vais prendre aussi deux ___ au chocolat.", "pains"],
  ["Boulang√®re", "Tr√®s bien. Ce sera tout ?", ""],
  ["Client", "Oui, merci. Combien je vous ___ ?", "dois"],
  ["Boulang√®re", "√áa fait trois euros cinquante, s‚Äôil vous pla√Æt.", ""],
  ["Client", "Voil√†. Merci beaucoup.", ""],
  ["Boulang√®re", "Merci √† vous. Bonne ___ !", "journ√©e"]
];

function speak(text) {
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = 'fr-FR';
  const voices = speechSynthesis.getVoices();
  const frenchVoice = voices.find(voice => voice.lang === 'fr-FR');
  if (frenchVoice) {
    utterance.voice = frenchVoice;
  }
  speechSynthesis.speak(utterance);
}

// Charger les voix √† temps dans Edge/Chrome
speechSynthesis.onvoiceschanged = () => {};

function createDialogue() {
  const container = document.getElementById("dialogue-container");
  container.innerHTML = "";
  for (let i = 0; i < dialogue.length; i++) {
    const [speaker, line, answer] = dialogue[i];
    const qId = `q${i + 1}`;
    const hasBlank = line.includes("___");
    let inputField = "";
    if (hasBlank) {
      inputField = `<input type='text' id='${qId}' placeholder='...'>`;
    }
    const displayLine = line.replace("___", inputField);
    const html = `<div class='question'><strong>${speaker}:</strong> ${displayLine} <button onclick="speak('${line.replace('___', answer)}')">üîä</button>
    <div id='exp${i + 1}' class='explanation'>‚úÖ ${line.replace('___', answer)}</div></div>`;
    container.innerHTML += html;
  }
}

function checkAnswers() {
  let score = 0;
  let total = 0;
  for (let i = 0; i < dialogue.length; i++) {
    const [_, line, answer] = dialogue[i];
    const qId = `q${i + 1}`;
    const exp = document.getElementById("exp" + (i + 1));
    const input = document.getElementById(qId);
    if (input) {
      total++;
      const val = input.value.trim().toLowerCase();
      input.classList.remove("correct", "missed");
      if (val === answer.toLowerCase()) {
        input.classList.add("correct");
        score++;
      } else {
        input.classList.add("missed");
      }
      exp.style.display = "block";
    }
  }
  const scoreText = document.getElementById("score");
  scoreText.innerText = `Vous avez ${score} bonne(s) r√©ponse(s) sur ${total}.`;
  scoreText.style.display = "block";
}

function resetDialogue() {
  for (let i = 0; i < dialogue.length; i++) {
    const qId = `q${i + 1}`;
    const exp = document.getElementById("exp" + (i + 1));
    const input = document.getElementById(qId);
    if (input) {
      input.value = "";
      input.classList.remove("correct", "missed");
    }
    if (exp) exp.style.display = "none";
  }
  document.getElementById("score").style.display = "none";
}

window.onload = createDialogue;
</script>

<p>
  <a href="../a1_dialogues.html">‚Üê Retour aux dialogues</a> |
  <a href="../../index.html">üè† Accueil</a>
</p>
</body>
</html>
